import{j as e}from"./ui-5CGx59HE.js";import{r as i}from"./vendor-Ce2S7JN_.js";import{s as a}from"./client-ClhMjqWB.js";import{c as s,u as r,C as t,e as l,f as n,b as o,B as m}from"./index-DXJv48IP.js";import{I as c}from"./input-BjLg3enW.js";import{T as u,a as d,b as h,c as p}from"./tabs-DlSAwCA0.js";import{C as j}from"./checkbox-Bqh3_0_U.js";import{b as x}from"./router-CrtsEgIx.js";import{A as g}from"./arrow-left-nPPkI31a.js";import"./supabase-FBsvvB2P.js";import"./utils-DN5cgeP9.js";import"./query-D7el4M-V.js";import"./ui-tabs-CFnylfyZ.js";import"./ui-form-bTH_Yx3M.js";import"./check-DVisVKU7.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=s("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),y=s("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),v=()=>{const[s,v]=i.useState(""),[b,w]=i.useState(""),[k,N]=i.useState(""),[S,C]=i.useState(!1),[E,q]=i.useState(null),[I,M]=i.useState(null),[D,K]=i.useState(!1),[_,R]=i.useState(!0),{toast:H}=r(),F=x();i.useEffect(()=>{const e=localStorage.getItem("rememberedEmail"),i="true"===localStorage.getItem("rememberMe");e&&i&&(v(e),R(!0));const{data:{subscription:s}}=a.auth.onAuthStateChange((e,i)=>{M(i),q(i?.user??null),i?.user&&F("/")});return a.auth.getSession().then(({data:{session:e}})=>{M(e),q(e?.user??null),e?.user&&F("/")}),()=>s.unsubscribe()},[F]);return E?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(t,{className:"w-full max-w-md",children:[e.jsxs(l,{className:"text-center",children:[e.jsxs(n,{children:["MirÃ« se vini, ",E.email,"!"]}),e.jsx("p",{className:"text-muted-foreground",children:"Ju jeni tÃ« lidhur"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs(m,{onClick:()=>F("/"),className:"w-full",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Kthehu nÃ« Faqen Kryesore"]}),e.jsx(m,{variant:"outline",onClick:async()=>{await a.auth.signOut(),H({title:"Dilni nga llogaria",description:"Shihemi sÃ«rish sÃ« shpejti!"})},className:"w-full",children:"Dilni"})]})]})}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs(t,{className:"w-full max-w-md",children:[e.jsxs(l,{className:"text-center",children:[e.jsx(n,{className:"text-2xl",children:"Llogaria KORAUTO"}),e.jsx("p",{className:"text-muted-foreground",children:"Hyni ose krijoni njÃ« llogari pÃ«r tÃ« ruajtur makinat tuaja tÃ« preferuara"})]}),e.jsxs(o,{children:[e.jsxs(u,{defaultValue:"signin",className:"w-full",children:[e.jsxs(d,{className:"grid w-full grid-cols-2",children:[e.jsx(h,{value:"signin",children:"Hyni"}),e.jsx(h,{value:"signup",children:"Regjistrohuni"})]}),e.jsx(p,{value:"signin",className:"space-y-4",children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),C(!0),K(!1);try{const{data:e,error:i}=await a.auth.signInWithPassword({email:s,password:b});if(i){if(i.message.includes("email not confirmed")||i.message.includes("signup requires email confirmation"))throw K(!0),new Error("Ju lutemi konfirmoni emailin tuaj pÃ«rpara se tÃ« hyni. Kontrolloni inbox-in dhe dosjen e spam-it.");throw i}if(e.user&&!e.user.email_confirmed_at)throw K(!0),new Error("Ju lutemi konfirmoni emailin tuaj pÃ«rpara se tÃ« hyni.");_?(localStorage.setItem("rememberedEmail",s),localStorage.setItem("rememberMe","true")):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("rememberMe")),H({title:"MirÃ« se erdhe! ðŸŽ‰",description:"U loguat me sukses"})}catch(i){H({title:"Hyrja DÃ«shtoi",description:i.message,variant:"destructive"})}finally{C(!1)}},className:"space-y-4",children:[e.jsx("div",{children:e.jsx(c,{type:"email",placeholder:"Email-i",value:s,onChange:e=>v(e.target.value),required:!0})}),e.jsx("div",{children:e.jsx(c,{type:"password",placeholder:"FjalÃ«kalimi",value:b,onChange:e=>w(e.target.value),required:!0})}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(j,{id:"rememberMe",checked:_,onCheckedChange:e=>R(!0===e)}),e.jsx("label",{htmlFor:"rememberMe",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Remember me"})]}),e.jsxs(m,{type:"submit",className:"w-full",disabled:S,children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),S?"Po hyni...":"Hyni"]}),D&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"Nuk keni konfirmuar emailin ende?"}),e.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:async()=>{if(s){C(!0);try{const{error:e}=await a.auth.resend({type:"signup",email:s,options:{emailRedirectTo:`${window.location.origin}/auth/confirm`}});if(e)throw e;H({title:"Email konfirmimi u dÃ«rgua! ðŸ“§",description:"Kontrolloni emailin tuaj dhe dosjen e spam-it."}),K(!1)}catch(e){H({title:"DÃ«shtoi dÃ«rgimi i emailit",description:e.message,variant:"destructive"})}finally{C(!1)}}else H({title:"Email i nevojshÃ«m",description:"Ju lutemi shkruani emailin tuaj tÃ« regjistrimit.",variant:"destructive"})},disabled:S,className:"w-full",children:"DÃ«rgo pÃ«rsÃ«ri emailin e konfirmimit"})]})]})}),e.jsx(p,{value:"signup",className:"space-y-4",children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),C(!0);try{const{data:e,error:r}=await a.auth.signUp({email:s,password:b,options:{data:{display_name:k},emailRedirectTo:`${window.location.origin}/auth/confirm`}});if(r)throw r;if(e.user&&!e.user.email_confirmed_at)try{await a.functions.invoke("send-confirmation-email",{body:{email:s,display_name:k,confirmation_url:`${window.location.origin}/auth/confirm?token=${e.user.id}&type=signup`}})}catch(i){}H({title:"Llogaria u Krijua! ðŸ“§",description:"Ju lutemi kontrolloni emailin tuaj pÃ«r tÃ« konfirmuar llogarinÃ«. Kontrolloni edhe dosjen e spam-it."})}catch(r){H({title:"Regjistimi DÃ«shtoi",description:r.message,variant:"destructive"})}finally{C(!1)}},className:"space-y-4",children:[e.jsx("div",{children:e.jsx(c,{type:"text",placeholder:"Emri pÃ«r Shfaqje",value:k,onChange:e=>N(e.target.value),required:!0})}),e.jsx("div",{children:e.jsx(c,{type:"email",placeholder:"Email-i",value:s,onChange:e=>v(e.target.value),required:!0})}),e.jsx("div",{children:e.jsx(c,{type:"password",placeholder:"FjalÃ«kalimi",value:b,onChange:e=>w(e.target.value),required:!0})}),e.jsxs(m,{type:"submit",className:"w-full",disabled:S,children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),S?"Po krijohet llogaria...":"Krijo Llogari"]})]})})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsxs(m,{variant:"ghost",onClick:()=>F("/"),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Return to Homepage"]})})]})]})})};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{v as default};
