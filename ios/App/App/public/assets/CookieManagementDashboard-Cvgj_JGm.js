var e=Object.defineProperty,s=(s,t,i)=>((s,t,i)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i)(s,"symbol"!=typeof t?t+"":t,i);import{j as t}from"./ui-5CGx59HE.js";import{r as i,a}from"./vendor-Ce2S7JN_.js";import{c as o,a as r,B as n,C as l,e as c,f as d,b as h,i as m}from"./index-DXJv48IP.js";import{I as u}from"./input-BjLg3enW.js";import{L as x}from"./label-CADau4dH.js";import{B as j}from"./badge-CtAh7DWu.js";import{A as f,b as p}from"./alert-BAzaEAh5.js";import{R as k,P as g}from"./progress-esslBWV-.js";import{T as C,a as S,b as v,c as N}from"./tabs-DlSAwCA0.js";import{S as b}from"./settings-CifkK-3H.js";import{S as y}from"./shield-2CMa0t69.js";import{C as w}from"./circle-alert-BSl6uMxW.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=o("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]),z=o("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),M=i.forwardRef(({className:e,...s},i)=>t.jsx("div",{className:"relative w-full overflow-auto",children:t.jsx("table",{ref:i,className:r("w-full caption-bottom text-sm",e),...s})}));
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */M.displayName="Table";const O=i.forwardRef(({className:e,...s},i)=>t.jsx("thead",{ref:i,className:r("[&_tr]:border-b",e),...s}));O.displayName="TableHeader";const _=i.forwardRef(({className:e,...s},i)=>t.jsx("tbody",{ref:i,className:r("[&_tr:last-child]:border-0",e),...s}));_.displayName="TableBody",i.forwardRef(({className:e,...s},i)=>t.jsx("tfoot",{ref:i,className:r("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";const A=i.forwardRef(({className:e,...s},i)=>t.jsx("tr",{ref:i,className:r("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));A.displayName="TableRow";const I=i.forwardRef(({className:e,...s},i)=>t.jsx("th",{ref:i,className:r("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));I.displayName="TableHead";const P=i.forwardRef(({className:e,...s},i)=>t.jsx("td",{ref:i,className:r("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));P.displayName="TableCell",i.forwardRef(({className:e,...s},i)=>t.jsx("caption",{ref:i,className:r("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption";class T{static validateCookie(e,s,t){const i=[],a=this.buildCookieString(e,s,t),o=new Blob([a]).size;return o>this.MAX_COOKIE_SIZE&&i.push(`Cookie "${e}" exceeds maximum size of ${this.MAX_COOKIE_SIZE} bytes (current: ${o} bytes)`),e&&0!==e.trim().length||i.push("Cookie name cannot be empty"),(e.includes("=")||e.includes(";")||e.includes(","))&&i.push("Cookie name contains invalid characters"),{isValid:0===i.length,errors:i,size:o}}static buildCookieString(e,s,t){let i=`${e}=${encodeURIComponent(s)}`;return t?.path&&(i+=`; path=${t.path}`),t?.domain&&(i+=`; domain=${t.domain}`),t?.maxAge&&(i+=`; max-age=${t.maxAge}`),t?.expires&&(i+=`; expires=${t.expires.toUTCString()}`),t?.secure&&(i+="; secure"),t?.httpOnly&&(i+="; httponly"),t?.sameSite&&(i+=`; samesite=${t.sameSite}`),i}static getCookieStats(){const e=document.cookie.split(";").filter(e=>e.trim().length>0).map(e=>{const[s,...t]=e.trim().split("="),i=t.join("="),a=new Blob([e.trim()]).size;return{name:s.trim(),size:a,value:i||""}}),s=e.reduce((e,s)=>e+s.size,0),t=e.reduce((e,s)=>s.size>e.size?s:e,{name:"",size:0});return{totalSize:s,cookieCount:e.length,largestCookie:t,cookies:e}}static checkTotalSizeLimit(e,s){const t=this.getCookieStats();let i=t.totalSize;if(s){const e=t.cookies.find(e=>e.name===s);e&&(i-=e.size)}return i+e<=this.MAX_TOTAL_SIZE}static setCookie(e,s,t){try{const i=this.validateCookie(e,s,t);if(!i.isValid)return!1;if(!this.checkTotalSizeLimit(i.size,e))return this.getCookieStats(),!1;const a=this.buildCookieString(e,s,t);return document.cookie=a,!0}catch(i){return!1}}static getCookie(e){const s=document.cookie.split(";");for(const t of s){const[s,...i]=t.trim().split("=");if(s===e)return i.join("=")?decodeURIComponent(i.join("=")):""}return null}static deleteCookie(e,s,t){const i={expires:new Date(0),path:s||"/",domain:t};document.cookie=this.buildCookieString(e,"",i)}static setSessionId(e){return this.setCookie(this.SESSION_COOKIE_NAME,e,{httpOnly:!1,secure:"https:"===window.location.protocol,sameSite:"strict",path:"/",maxAge:86400})}static getSessionId(){return this.getCookie(this.SESSION_COOKIE_NAME)}static clearSession(){this.deleteCookie(this.SESSION_COOKIE_NAME)}static setPreferences(e){try{const s=JSON.stringify(e);return this.setCookie(this.PREFERENCES_COOKIE_NAME,s,{secure:"https:"===window.location.protocol,sameSite:"lax",path:"/",maxAge:2592e3})}catch(s){return!1}}static getPreferences(){try{const e=this.getCookie(this.PREFERENCES_COOKIE_NAME);return e?JSON.parse(e):null}catch(e){return null}}static updatePreferences(e){const s={...this.getPreferences()||{},...e};return this.setPreferences(s)}static clearAllCookies(){this.getCookieStats().cookies.forEach(e=>{this.deleteCookie(e.name)})}static monitorUsage(){const e=this.getCookieStats();return e.totalSize,this.MAX_TOTAL_SIZE,e.cookies.forEach(e=>{e.size,this.MAX_COOKIE_SIZE}),e}static optimizeCookies(){const e=this.getCookieStats();e.totalSize>.9*this.MAX_TOTAL_SIZE&&e.cookies.sort((e,s)=>s.size-e.size)}}s(T,"MAX_COOKIE_SIZE",1024),s(T,"MAX_TOTAL_SIZE",4096),s(T,"SESSION_COOKIE_NAME","session_id"),s(T,"PREFERENCES_COOKIE_NAME","user_preferences");const{setCookie:R,getCookie:K,deleteCookie:B,setSessionId:F,getSessionId:U,clearSession:$,setPreferences:L,getPreferences:V,updatePreferences:Z,clearAllCookies:X,getCookieStats:D,monitorUsage:q,optimizeCookies:G}=T,H=()=>{const{stats:e,refreshStats:s,optimize:o,clearAll:r}=function(){const[e,s]=i.useState(null),[t,a]=i.useState(!0),o=i.useCallback(()=>{const e=T.getCookieStats();return s(e),e},[]);i.useEffect(()=>{o(),a(!1);const e=setInterval(()=>{o()},5e3);return()=>clearInterval(e)},[o]);const r=i.useCallback(()=>{T.optimizeCookies(),o()},[o]),n=i.useCallback(()=>{T.clearAllCookies(),o()},[o]);return{stats:e,refreshStats:o,optimize:r,clearAll:n,loading:t}}(),{sessionId:R,generateSession:K,clearSession:B}=function(){const[e,s]=i.useState(null),[t,a]=i.useState(!0);i.useEffect(()=>{const e=T.getSessionId();s(e),a(!1)},[]);const o=i.useCallback(e=>{const t=T.setSessionId(e);return t&&s(e),t},[]),r=i.useCallback(()=>{T.clearSession(),s(null)},[]),n=i.useCallback(()=>{const e=crypto.randomUUID?crypto.randomUUID():"sess_"+Math.random().toString(36).substring(2)+Date.now().toString(36);return o(e)},[o]);return{sessionId:e,setSession:o,clearSession:r,generateSession:n,loading:t}}(),{preferences:F,updatePreferences:U}=function(e){const[s,t]=i.useState(null),[a,o]=i.useState(!0);i.useEffect(()=>{const s=T.getPreferences();t(s||e||null),o(!1)},[e]);const r=i.useCallback(e=>{const i=T.updatePreferences(e);if(i){const i={...s||{},...e};t(i)}return i},[s]),n=i.useCallback(e=>{const s=T.setPreferences(e);return s&&t(e),s},[]),l=i.useCallback(()=>{T.deleteCookie("user_preferences"),t(null)},[]);return{preferences:s,updatePreferences:r,setPreferences:n,clearPreferences:l,loading:a}}({theme:"system",language:"en",notifications:!0,autoSave:!0}),[$,L]=a.useState(""),[V,Z]=a.useState(""),X=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB"][s]},D=(e,s)=>{const t=e/s*100;return t>90?"bg-red-500":t>70?"bg-yellow-500":"bg-green-500"},q=(e,s)=>{const t=e/s*100;return t>90?"destructive":t>70?"default":"secondary"};if(!e)return t.jsx("div",{children:"Loading cookie stats..."});const G=e.totalSize/4096*100,H=e.largestCookie.size>0?e.largestCookie.size/1024*100:0;return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Paneli i Menaxhimit të Cookie-ve"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitoroni dhe menaxhoni cookie-t e aplikacionit me kufizime madhësie"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(n,{onClick:s,variant:"outline",size:"sm",children:[t.jsx(k,{className:"h-4 w-4 mr-2"}),"Refresh"]}),t.jsxs(n,{onClick:o,variant:"outline",size:"sm",children:[t.jsx(b,{className:"h-4 w-4 mr-2"}),"Optimize"]})]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[t.jsxs(l,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(d,{className:"text-sm font-medium",children:"Total Cookie Usage"}),t.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(h,{children:[t.jsx("div",{className:"text-2xl font-bold",children:X(e.totalSize)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"of 4KB limit"}),t.jsx(g,{value:G,className:`mt-2 ${D(e.totalSize,4096)}`})]})]}),t.jsxs(l,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(d,{className:"text-sm font-medium",children:"Cookie Count"}),t.jsx(j,{variant:"secondary",children:e.cookieCount})]}),t.jsxs(h,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.cookieCount}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"active cookies"})]})]}),t.jsxs(l,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(d,{className:"text-sm font-medium",children:"Largest Cookie"}),t.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(h,{children:[t.jsx("div",{className:"text-2xl font-bold",children:X(e.largestCookie.size)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:String(e.largestCookie.name||"None")}),t.jsx(g,{value:H,className:`mt-2 ${D(e.largestCookie.size,1024)}`})]})]})]}),G>80&&t.jsxs(f,{children:[t.jsx(w,{className:"h-4 w-4"}),t.jsxs(p,{children:["Cookie storage is approaching the 4KB limit (",Math.round(G),"% used). Consider removing unnecessary cookies."]})]}),t.jsxs(C,{defaultValue:"cookies",className:"space-y-4",children:[t.jsxs(S,{children:[t.jsx(v,{value:"cookies",children:"Të gjitha Cookie-t"}),t.jsx(v,{value:"session",children:"Menaxhimi i Sesionit"}),t.jsx(v,{value:"preferences",children:"Preferencat e Përdoruesit"}),t.jsx(v,{value:"add",children:"Shto Cookie"})]}),t.jsx(N,{value:"cookies",children:t.jsxs(l,{children:[t.jsxs(c,{children:[t.jsx(d,{children:"All Cookies"}),t.jsx(m,{children:"View and manage all active cookies"})]}),t.jsxs(h,{children:[t.jsxs(M,{children:[t.jsx(O,{children:t.jsxs(A,{children:[t.jsx(I,{children:"Name"}),t.jsx(I,{children:"Size"}),t.jsx(I,{children:"Value Preview"}),t.jsx(I,{children:"Actions"})]})}),t.jsx(_,{children:e.cookies.map(e=>t.jsxs(A,{children:[t.jsx(P,{className:"font-medium",children:String(e.name)}),t.jsx(P,{children:t.jsx(j,{variant:q(e.size,1024),children:X(e.size)})}),t.jsx(P,{className:"max-w-xs truncate",children:String(e.value).length>50?`${String(e.value).substring(0,50)}...`:String(e.value)}),t.jsx(P,{children:t.jsx(n,{variant:"destructive",size:"sm",onClick:()=>{return t=String(e.name),T.deleteCookie(t),void s();var t},children:t.jsx(z,{className:"h-4 w-4"})})})]},String(e.name)))})]}),0===e.cookies.length&&t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No cookies found"})]})]})}),t.jsx(N,{value:"session",children:t.jsxs(l,{children:[t.jsxs(c,{children:[t.jsx(d,{children:"Session Management"}),t.jsx(m,{children:"Manage user session with secure cookies"})]}),t.jsxs(h,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(x,{children:"Current Session ID"}),t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsx(u,{value:R||"No session",readOnly:!0,className:"font-mono text-sm"}),t.jsx(n,{onClick:K,variant:"outline",children:"Generate New"}),t.jsx(n,{onClick:B,variant:"destructive",children:"Clear Session"})]})]}),t.jsxs(f,{children:[t.jsx(y,{className:"h-4 w-4"}),t.jsx(p,{children:"Session cookies are automatically configured with Secure and SameSite attributes for enhanced security."})]})]})]})}),t.jsx(N,{value:"preferences",children:t.jsxs(l,{children:[t.jsxs(c,{children:[t.jsx(d,{children:"Preferencat e Përdoruesit"}),t.jsx(m,{children:"Menaxhoni preferencat e aplikacionit të ruajtura në cookie"})]}),t.jsx(h,{className:"space-y-4",children:t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs("div",{children:[t.jsx(x,{htmlFor:"theme",children:"Tema"}),t.jsxs("select",{id:"theme",value:F?.theme||"system",onChange:e=>U({theme:e.target.value}),className:"w-full mt-1 p-2 border rounded-md",children:[t.jsx("option",{value:"light",children:"E Lehtë"}),t.jsx("option",{value:"dark",children:"E Errët"}),t.jsx("option",{value:"system",children:"Sistemi"})]})]}),t.jsxs("div",{children:[t.jsx(x,{htmlFor:"language",children:"Gjuha"}),t.jsxs("select",{id:"language",value:F?.language||"sq",onChange:e=>U({language:e.target.value}),className:"w-full mt-1 p-2 border rounded-md",children:[t.jsx("option",{value:"sq",children:"Shqip"}),t.jsx("option",{value:"en",children:"Anglisht"}),t.jsx("option",{value:"ko",children:"Koreane"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"checkbox",id:"notifications",checked:F?.notifications||!1,onChange:e=>U({notifications:e.target.checked})}),t.jsx(x,{htmlFor:"notifications",children:"Aktivizo Njoftimet"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"checkbox",id:"autoSave",checked:F?.autoSave||!1,onChange:e=>U({autoSave:e.target.checked})}),t.jsx(x,{htmlFor:"autoSave",children:"Ruajtja Automatike"})]})]})})]})}),t.jsx(N,{value:"add",children:t.jsxs(l,{children:[t.jsxs(c,{children:[t.jsx(d,{children:"Add New Cookie"}),t.jsx(m,{children:"Create a new cookie with automatic size validation"})]}),t.jsxs(h,{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(x,{htmlFor:"cookieName",children:"Cookie Name"}),t.jsx(u,{id:"cookieName",value:$,onChange:e=>L(e.target.value),placeholder:"Enter cookie name"})]}),t.jsxs("div",{children:[t.jsx(x,{htmlFor:"cookieValue",children:"Cookie Value"}),t.jsx(u,{id:"cookieValue",value:V,onChange:e=>Z(e.target.value),placeholder:"Enter cookie value"})]}),t.jsx(n,{onClick:()=>{$&&V&&T.setCookie($,V,{path:"/",secure:"https:"===window.location.protocol,sameSite:"lax",maxAge:604800})&&(L(""),Z(""),s())},disabled:!$||!V,children:"Add Cookie"}),t.jsxs(f,{children:[t.jsx(w,{className:"h-4 w-4"}),t.jsx(p,{children:"Cookies are automatically validated for size limits (max 1KB per cookie, 4KB total). Secure and SameSite attributes are applied automatically."})]})]})]})})]}),t.jsxs(l,{children:[t.jsxs(c,{children:[t.jsx(d,{children:"Quick Actions"}),t.jsx(m,{children:"Common cookie management operations"})]}),t.jsx(h,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(n,{onClick:r,variant:"destructive",children:"Clear All Cookies"}),t.jsx(n,{onClick:()=>T.monitorUsage(),variant:"outline",children:"Monitor Usage"}),t.jsx(n,{onClick:o,variant:"outline",children:"Optimize Storage"})]})})]})]})},J=Object.freeze(Object.defineProperty({__proto__:null,CookieManagementDashboard:H,default:H},Symbol.toStringTag,{value:"Module"}));export{E as C,H as a,J as b};
